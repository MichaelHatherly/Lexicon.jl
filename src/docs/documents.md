# Documents

*Documents* for creating static documentation are defined using a tree structure.

There are three main types that make up the nodes of the tree which have corresponding methods.

* Document: Root node of the tree structure
* Section:  Separates the documentation into different parts
* Page:     A page node contains the *content nodes* of the documentation

There are two additional container types which can group multiple pages.

* Preformat:    a group container which is used for multiple pages with ready content like
  manual files or pre-rendered content.
* Pages:        simple group container for multiple page nodes


## High Level Nodes

There are three high level nodes.

* Section: has two high level implementation

    * Multi-modules (e.g. package) section: autogenerates each module within a separate page

    ```julia
    out = document("Docile Documentation",
        section("Package API",
            packagemodules(Docile),
            ),
        )

    ```

    * Single module section: autogenerates each category within a separate page

    ```julia
    out = document("Docile Documentation",
        section(Docile.Cache, config(autogenerate_categories=[:method, :macro], autogenerate_internal=true))
        )

    ```

* Page: has a high level version

    * Single module page: autogenerates all categories within one page

    ```julia
    out = document("Docile Documentation",
        section("API-Autogenerated",
            page(Docile.Cache, config(autogenerate_categories=[:method, :macro], autogenerate_internal=false)),
            ),
        )

    ```

---

## Main tree structure

### Document

A *Document* is the root node of the *documentation structure* and creates a context for the
resulting documentation.

* `name`:       Name for the Document
* `children`:   Sections

An document with default configuration can be created with the method `document`.

If a customised configuration is desired a `config()` can be used as argument to overwrite any
default configuration values.

```julia
out = document("Lexicon Documentation", config(a=1500, c=565656),
    )

```

### Section

A *Section* is used to separate the documentation into different parts.

* `name`:       Name for the Section
* `children`:   Other Sections, Pages or one or more single Page nodes
* `parent`:     Reference to the parent: Document or parent Section

A section with inherited configuration of the parent can be created with the method `section`.

If a customised configuration for this particular section sub-tree is desired a `config()` can be
used as argument to overwrite any inherited configuration values.

```julia
out = document("Lexicon Documentation",
    section("Manual Section", config(a=1500, c=565656),
        ),
    )

```

NOTE: `section` has also a highlevel method which auto generates pages for a module.

```julia
import Docile: Cache
out = document("Lexicon Documentation",
    section(Cache, config(automod_categories=[:module, :method])),
    )

```

### Page

A *Page* is used to contain the different *content nodes* of the documentation.

* `name`:       Name for the Page
* `children`:   ContentNodes
* `parent`:     Reference to the parent: Pages node or Section

A page with inherited configuration of the parent can be created with the method `pages`.

If a customised configuration for this particular page sub-tree is desired a `config()` can be
used as argument to overwrite any inherited configuration values.

```julia
out = document("Lexicon Documentation",
    section("Manual Section",
        page("Overview", config(a=1500, c=565656),
            ),
        ),
    )

```

NOTE: `section` has also a highlevel method which auto generates pages for a module.

```julia
import Docile: Cache
out = document("Lexicon Documentation",
    section("API",
        page(Cache, config(automod_categories=[:module, :method]),
            ),
        ),
    )

```

---

## Group containers

### Preformat

A *Preformat* node is used for multiple preformatted pages with ready content like manual files or
pre-rendered content.

* `name`:       Name for the Preformat node
* `children`:   One or more tuples (PreformatPage Name, PreformatPage data)

  * NOTE: if the `PreformatPage data` matches an acutally file path that file is read instead if it.

* `parent`:     Reference to the parent: Section

A *Preformat* node will generate children of the type: *PreformatPage*

* `name`:       Name for the PreformatPage node
* `parent`:     Reference to the parent: Preformat
* `data`:       The preformatted data content.

A preformat group node with inherited configuration of the parent can be created with the method `preformat`.

If a customised configuration for this particular content sub-tree is desired a `config()` can be
used as argument to overwrite any inherited configuration values.

```julia
out = document("Lexicon Documentation",
    section("Manual Section",
        preformat("Group of pages", config(a=1500, c=565656),
            ),
        ),
    )

```

```julia
out = document("Lexicon Documentation",
    section("Manual Section",
        preformat("Group of pages", config(a=1500, c=565656),
                ("Overview",   "files/overview.md"),
                ("OtherPage",  "Some long preformatted text or ready rendered content"),
            ),
        ),
    )

```

### Pages

A *Pages* node is used to group multiple single Page nodes.

* `name`:       Name for the Pages node
* `children`:   One or more single Page nodes
* `parent`:     Reference to the parent: Section

A pages group node with inherited configuration of the parent can be created with the method `pages`.

If a customised configuration for this particular pages sub-tree is desired a `config()` can be
used as argument to overwrite any inherited configuration values.

```julia
out = document("Lexicon Documentation",
    section("Manual Section",
        pages("Group of pages", config(a=1500, c=565656),
            ),
        ),
    )

```

---

## Others


### Page ContentNode

A *ContentNode* is used to contain the actual contents of the documentation.
This includes, but is not limited to the contents of an external file such as *manual.md*, the
docstrings from a module or group of modules, intermediate text, api reference index etc.

*ContentNodes* can easily be defined outside of the package and allow for package authors to
customise how content is integrated into the page sub-tree.

Default ContentNodes:

* `children`:   Default ContentNodes do not have any children
* `parent`:     Reference to the parent: Page
* `data`:       The actual data of the content node: e.g. AbstractString, Vetor of documented objects

Default ContentNodes inherited the configuration of the parent.

If a customised configuration for this particular content node is desired, keyword arguments can be
used to overwrite any inherited configuration values.

```julia
out = document("Lexicon Documentation",
    section("Manual Section",
        page("Overview",
            title("Lexicon"; a=1500, c=565656),
            ),
        ),
    )

```

### Config

The configuration of the document tree is passed down to each child node and can be customised at
most states.

At initialisation nodes contain a `PreConfig` with only the *configuration fields/values* which
needs to be customised.

When the whole document tree is created the parents and final configuration will be resolved.

Modification to a  nodes configuration are always applied to a deepcopy of it's parents configuration
and effects only that particular node inclusive any sub-tree nodes.

**Inherited customised configuration** allows package authors to generate the desired output with ease.

* At the top level: `document()` one defines the most general configuration needed for all sub-nodes.
* At the `section()` level one can specify for each section sub-tree a more specified configuration.
* If needed one can set for each page an even more specified  `page()` configuration.
* `ContentNodes` inherit the parents  `page()` configuration and usually need only in special cases
  any adjustments.

* At the group container level: `pages()` or `content()` cone can also modify the inherited
  configuration

```julia
out = document("Lexicon Documentation", config(example=1500, permalink=true, emphasis=""),
    section("API Section", config(example=5),
        page("Lexicon", config(example=300),
            title("Lexicon"),
            textfile("docs/manual.md"),
            header("Exported"; permalink=false),
            subheader("Methods"; emphasis="*"),
            objs(Lexicon, Method),
            subheader("Types"),
            objs(Lexicon, DataType),
            subheader("Macros"),
            objs(Lexicon, :macro),
            ),
        ),
    )
```
